---
layout: page
title:  "曲线和网格"
author: mosfet
category: scene
tags: 场景 曲线 网格
---
在计算机图形领域，某些mesh网格由于其在研究，测试和教育中的广泛使用而获得了标志性的名声。两个最著名的例子是：  
`斯坦福兔子(stanford bunny)`：1994年在斯坦福大学创建的这款兔子的3D模型由69,451个三角形组成。它已广泛用于测试与渲染，压缩和mesh处理相关的算法。  
`犹他州茶壶(utah teapot)`：该茶壶是计算机图形学的象征。它的光滑，对称的表面使其非常适合在着色，照明和渲染技术方面进行早期实验。但它仍然是一种怀旧而实用的教学工具。  

我通常只写图像顺序渲染。它们是否可以处理大型网格？答案通常是，很困难，甚至流行的社区中几乎没有演示。其原因无非是这两种渲染对于曲面的极端看法。  
如果每个像素需要遍历所有三角形，这种计算量超出想象。即使只有少量三角形，至少我们可以想到，利用空间结构进行编排的可能性为99.99%。第二是，使用射线交叉三角形比SDF更快。  

最后就是实际问题，在单个着色器中真的可行吗？唯一的选择是硬编码它们进行编译，包括加速结构的交叉测试，完全手工。  

---
## 为什么是网格？
曲面本身由数学进行表达，正如我们所熟悉的，图形中经常使用隐式或参数形式。  
由于光栅化从原图开始处理对象，曲面通常预先计算为网格集合，以符合**对象顺序渲染**。因此，我们大概可以找到这两种方式各自对于处理曲面的观点差异。  

**ref(Focg15.)**。  
某些曲线的名称由于其形状广为人知，另一些几乎可以是任何形状，它们是自由(free-form)曲线。  
数学上指定曲线(curve)有三种形式，**①隐式②参数；③生成程序曲线。**生成点，但与前两类无关。  

我们已经发现特定曲线同时存在简单的隐式和参数形式，例如圆形，但通常情况下很难找到参数表示。  
经常，我们考虑最终使用曲线时使用**标准化**`0..1`域，该参数要找到对原始曲线的间隔映射很容易。  
复杂的曲线可以由多个参数曲线**划分、合并**构造(divide-and-conquer)。因此我们的基本线，圆和椭圆派得上用场。它们是许多简单的较小零件，自身可以简单解释。本质上我们需要对标准域重新分割。

我们可能对一条曲线某个位置进行观察，如曲率、方向。在创建方面，我们期望一条曲线经过我们想要的点，称为插值点。该插值结果的特定域称为插值域。  

有一些元件的形式：  
```ruby
# Segment
f(u) = (1-u)p1 + (u)p2          # 2 pos
     = p1-up1 + up2
# ro+rd这种形式在向量上进行合成也更直观，但只有第一个点是点
# 相反，我们把方向记为a2，并假设a1是一个点
f(u) = 1a1 + (u)a2              # p + ua2
     = dot([a],[1u])

# thus       1u
     f(0) = [10]·[a] = a1       # 即第一个点
     f(1) = [11]·[a] = a1+a2    # 即移动后的位置
# thus matrix form
A= 1 0 *[a] = [dot1, dot2]      # Ar是参数行，我们可以得到两端的位置在哪里
   1 1
=> C([a]) = p                   # C: constraint matrix
let     B = C^-1                # B: basis matri
     f(u)= uB(p)                # 从技术上讲，这些只是更好的表示形式

# 15.3.3
f(u) = a1 + ua2 + u^2a3         # poly quadratics  值得注意的是，最后一个点f(1)=p+1a2+1a3
f(u) = a1 + ua2 + u^2a3 + u^3a4 # poly cubic

# blending function
b(u) = uB
# 我们不知道这是干嘛的

# 15.3.6~15.5 略
```

**近似线(approximating curves)**  
控制曲线的最简单方法似乎是指定一组要插值的点。但是，在实践中，插值方案通常具有不良属性，通常优选仅近似点的曲线方案。使用近似方案，**控制点**(不在曲线上)会影响曲线的形状，但不能准确指定。尽管我们放弃了直接指定要通过的点的能力，但我们获得了曲线和局部控制的更好行为。  
两种近似曲线类型是`Bezier(贝塞尔)`和`B-Spline`曲线。  
三次贝塞尔由四个点控制。有两个位置`p0,p3`在插值中出现，因为`u = 1/0`的情况，中间的点是控制点。  
```ruby
f(u) =(1-3u+3u^2-u^3)p0 +(3u-6u^2+3u^3)p1 +(3u^2-3u^3)p2 +(u^3)p3
```