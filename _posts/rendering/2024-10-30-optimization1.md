---
layout: page
title:  "GI优化技术"
author: mosfet
category: rendering
tags: 全局照明 优化
---

本文需要更新。  

## 回顾蒙特卡洛
通常情况下笔者不会重复赘述前提知识，**例外**的是蒙特卡洛的复杂性。如果目前已经熟悉辐射度理论，那么跳过这段话。  

我假设您知道使用积分和格来测量域这一事实；第二，通过两个积分比率可以得到新引入fx函数的同域平均值。  
采样出空间中特定值的概率分布称为该随机采样变量相关的概率密度函数PDF，简单来说，这是一个因子。  

我们用x、f(x)表示一个随机变量或任意随机结果函数，例如渲染结果的特定像素。  
望值是一种对概率修正乘以实际值的积分，其定义`E(f(x)) = ∫f(x)p(x)dx`通过求和衰减实际值的概率因子获得总体上的平均值。换句话说，它查询整个域。  
当密度相同时，一堆独立随机样本变量iid——通过`x1+x2+.../n`这种方式可以相当简单地获得数值期望解，而无需解析积分形式（但同样应该遵循密度函数以修正迭代值）。这就是蒙特卡洛数值积分方法。  
```ruby
E(f(x)) = ∫f(x)p(x)dx           # E本身就是两项
        ~= 1/N * Σ(i=1..N)xi.   # 数值均值估计

        # 通常，将估计写成g/p的形式称为蒙特卡洛积分
E(f(x)) = ∫f(x)p(x)dx
        ~= 1/N [Σ(i=1..N)g(xi)/p(xi)]
        # 即原始的f(x)p(x) = g，并显式除以p
```

---
## 参考1
熟悉[《Ray Tracing: The Rest of Your Life》](https://raytracing.github.io/books/RayTracingTheRestOfYourLife.html)这本书的读者  
可能记得Peter Shirley列举了几种重要性采样的实践，如更匹配漫反射BRDF的PDF和非均匀采样。更具启发意义的可能是灯光PDF以及采样(强制导向灯光)。这种直接光采样不同于常规的全局照明方法，但可以达到基本正确的结果。如果您理解了全局光照的问题，则可以理解这种方法的合理性。我在这里再次强调理解问题本身更重要，而不是推崇某种解决方案，读者需要自己理解可行性并决定自己的使用偏好。  
若不清楚选择PDF以及采样行为对结果的不同影响，请见光线追踪一文。  
<div class="x gr txac">
  <div class="x la flex mg0">
    <div class="x la item3-lg item12 pd0">
      <img src="/assets/i/4-1.png">
    </div>
  </div>
  <p>图1：增强灯光的贡献</p>
</div>

